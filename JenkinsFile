pipeline {
	agent any
	  tools {
                 maven 'Maven'
                 jdk 'JDK11'
               }
	  

	  stages {
              stage('Build maven ') {
                   steps { 
                     sh 'pwd'      
                     sh 'mvn  clean install package'
                    }
                 }
        
              stage('Copy Artifact') {
                   steps { 
                     sh 'pwd'
		                 sh 'cp -r target/*.jar docker'
                    }
                 }
         
              stage('Build docker image') {
                   steps {
                      script { 
			                   sh "docker build -t pet-app:v1 ./docker"
			
			   }                     
                    }
              }
       // Uploading Docker images into dockerhub
	     stage('Pushing to dockerhub') {
		   steps{
		       script {
			       docker.withRegistry('https://registry.hub.docker.com', 'dockerhub')
             docker push pet-app:v1
             docker run -d -p 8082:8080 -t pet-app:v1
             
             
			       
			       }
			    }
			}
		  
            
    
	  }
}
